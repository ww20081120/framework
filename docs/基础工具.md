### ç®€ä»‹

å®šä¹‰å…¬ç”¨çš„å¸¸é‡ã€å·¥å…·ç±»ï¼Œé‡‡ç”¨Spring Bootæ–¹å¼å¯åŠ¨ï¼Œå¯åŠ¨ç±»ä¸ºApplicationï¼Œä¹Ÿæ”¯æŒWebæ–¹å¼å¯åŠ¨ã€‚

æ¡†æ¶æä¾›äº†ä¸€å¥—å®Œæ•´çš„é€šç”¨å·¥å…·ç±»ï¼Œæ¶µç›–å¼‚å¸¸å¤„ç†ã€èµ„æºé…ç½®ã€å¯åŠ¨ç›‘å¬ã€æ–­è¨€ã€æ—¥å¿—ã€æ—¥æœŸå¤„ç†ã€å¸¸ç”¨å·¥å…·æ–¹æ³•ã€æ–‡ä»¶æµå¤„ç†ã€æ¨¡æ¿å¼•æ“ã€HTTPè¯·æ±‚ã€æ•°æ®å®‰å…¨å¤„ç†ã€åºåˆ—åŒ–ã€XMLå¤„ç†ç­‰å¤šä¸ªæ–¹é¢ã€‚

### æ¡†æ¶å¯åŠ¨æµç¨‹

æ¡†æ¶å¯åŠ¨é€šè¿‡Bootstrapç±»è¿›è¡Œç®¡ç†ï¼Œæä¾›äº†åœ¨Springå®¹å™¨åŠ è½½å‰åçš„åˆå§‹åŒ–é’©å­ï¼š

> Bootstrap.java

```java
public final class Bootstrap {
    public static void before() {
        // åœ¨Springå®¹å™¨åŠ è½½å‰æ‰§è¡Œåˆå§‹åŒ–
        // è®¾ç½®ä»£ç†ã€åŠ è½½å¯åŠ¨ç›‘å¬å™¨ç­‰
    }
    
    public static void after(final ApplicationContext context) {
        // åœ¨Springå®¹å™¨åŠ è½½å®Œæˆåæ‰§è¡Œ
        // æ‰“å°å¯åŠ¨æˆåŠŸä¿¡æ¯ã€æ‰§è¡Œå¯åŠ¨ç›‘å¬å™¨çš„completeæ–¹æ³•ç­‰
    }
}
```

åœ¨Applicationç±»ä¸­éœ€è¦è°ƒç”¨Bootstrapçš„æ–¹æ³•ï¼š

```java
@SpringBootApplication
public class Application {
    public static void main(final String[] args) {
        Bootstrap.before(); // å¯åŠ¨å‰åˆå§‹åŒ–
        ConfigurableApplicationContext context = SpringApplication.run(Application.class, args);
        Bootstrap.after(context); // å¯åŠ¨åå¤„ç†
    }
}
```

### å¼‚å¸¸çš„å®šä¹‰

å¼‚å¸¸çš„é¡¶çº§APIæ˜¯FrameworkExceptionï¼Œè¯¥ç±»ç»§æ‰¿äº†RuntimeExceptionï¼Œå»ºè®®é¡¹ç›®é‡Œé¢çš„å¼‚å¸¸éƒ½åœ¨æœ€å¤–å±‚è¿›è¡Œç»Ÿä¸€å¤„ç†ã€‚

å¸¸è§çš„å¼‚å¸¸æœ‰ï¼š

* UtilException - å·¥å…·ç±»å¼‚å¸¸
* ServiceException - ä¸šåŠ¡æœåŠ¡å¼‚å¸¸
* AssertException - æ–­è¨€é”™è¯¯
* DaoException - æ•°æ®åº“å¼‚å¸¸
* InitializationException - åˆå§‹åŒ–å¯åŠ¨å¼‚å¸¸

æ¡†æ¶å®šä¹‰äº†ä¸°å¯Œçš„é”™è¯¯ç ï¼Œä½äºcom.hbasesoft.framework.common.ErrorCodeDefï¼š

* 0-999: æ¡†æ¶ä¿ç•™é”™è¯¯ç 
* 1000-9999: æˆåŠŸçŠ¶æ€ç 
* 10000-99999: é”™è¯¯çŠ¶æ€ç 
* 100000+: é¡¹ç›®è‡ªå®šä¹‰é”™è¯¯ç 

> ErrorCodeDef.java (éƒ¨åˆ†)

```java
public enum ErrorCodeDef implements ErrorCode {
    /** æˆåŠŸ */
    SUCCESS(0, "æˆåŠŸ"),

    /** ç³»ç»Ÿé”™è¯¯ */
    FAILURE(1, "ç³»ç»Ÿé”™è¯¯"),

    /** ç¼“å­˜å¤±è´¥ */
    CACHE_ERROR(2, "ç¼“å­˜å¤±è´¥"),
    
    // ... æ›´å¤šé”™è¯¯ç å®šä¹‰
}
```

é”™è¯¯ä¿¡æ¯æè¿°åœ¨errorMessage.propertiesä¸­ç»´æŠ¤ã€‚å¦‚æœæƒ³å®šä¹‰è‡ªå·±çš„é¡¹ç›®é”™è¯¯æè¿°ï¼Œå¯ä»¥åœ¨application.ymlä¸­é€šè¿‡extend.errorMessage.filesæ‰©å±•é…ç½®ï¼Œå¤šä¸ªç”¨è‹±æ–‡é€—å·åˆ†éš”ã€‚

```yaml
extend:
  errorMessage:
    files: errorMessage_msg.properties
```

### å¸¸é‡å®šä¹‰

æ¡†æ¶æä¾›äº†ä¸€ç³»åˆ—é€šç”¨å¸¸é‡ï¼Œä½äºcom.hbasesoft.framework.common.GlobalConstantsï¼š

```java
public interface GlobalConstants {
    /** åˆ†éš”ç¬¦ */
    String SPLITOR = ",";

    /** è·¯å¾„åˆ†å‰²ç¬¦ */
    String PATH_SPLITOR = "/";

    /** ç©ºç™½ */
    String BLANK = "";

    /** é»˜è®¤ç¼–ç  */
    Charset DEFAULT_CHARSET = Charset.forName("utf-8");

    /** ä¸€ç§’ç­‰äº1000æ¯«ç§’ */
    int SECONDS = 1000;

    /** é»˜è®¤è¡Œ */
    int DEFAULT_LINES = 1000;
    
    // ... æ›´å¤šå¸¸é‡å®šä¹‰
}
```

### èµ„æºæ–‡ä»¶è·å–

èµ„æºæ–‡ä»¶æ”¯æŒä½¿ç”¨propertieså’Œymlä¸¤ç§æ–¹å¼è¿›è¡Œé…ç½®ï¼Œä¸¤ç§éƒ½å†™åªä»ymlä¸­è¯»å–ã€‚application.ymlæ–‡ä»¶ä¸­é…ç½®çš„å†…å®¹å¯ä»¥ä½¿ç”¨com.hbasesoft.framework.common.utils.PropertyHolderä¸­çš„æ–¹æ³•æ¥è·å–ã€‚

> PropertyHolderTest.java

```java
@Test
public void getProperty() {
    String a = PropertyHolder.getProperty("test.str.str2");
    Assert.equals(a, "bcd", ErrorCodeDef.SYSTEM_ERROR_10001);

    a = PropertyHolder.getProperty("test.str.none", "abcdefg");
    Assert.equals(a, "abcdefg", ErrorCodeDef.SYSTEM_ERROR_10001);

    a = PropertyHolder.getProperty("test.int.int2");
    Assert.equals(a, "-1", ErrorCodeDef.SYSTEM_ERROR_10001);

    a = PropertyHolder.getProperty("test.long.long2");
    Assert.equals(a, "3000", ErrorCodeDef.SYSTEM_ERROR_10001);

    a = PropertyHolder.getProperty("test.bool.bool2");
    Assert.equals(a, "false", ErrorCodeDef.SYSTEM_ERROR_10001);
}
```

é¢å¤–æ‰©å±•çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨application.ymlä¸­é€šè¿‡extend.property.filesæ¥æ‰©å±•ï¼Œå¤šä¸ªç”¨è‹±æ–‡é€—å·åˆ†éš”ï¼Œä»£ç ä¸­è·å–åŒapplication.ymlä¸€æ ·ã€‚

> application.yml

```yaml
project:
  name: demo

test:
  str:
    str1: abc
    str2: bcd
  int:
    int1: 1
    int2: -1
  long:
    long1: 1000
    long2: 3000
  bool:
    bool1: true
    bool2: false
    
extend:
  property:
    files: ext01.properties, ext02.yml
  errorMessage:
    files: ext_errorMessage.properties
```

### Springä¸Šä¸‹æ–‡å·¥å…·

æ¡†æ¶æä¾›äº†ContextHolderæ¥è·å–Springçš„ApplicationContextï¼š

```java
@Service
public class SomeService {
    public void doSomething() {
        // è·å–Springä¸Šä¸‹æ–‡
        ApplicationContext context = ContextHolder.getContext();
        
        // ä»ä¸Šä¸‹æ–‡ä¸­è·å–Bean
        SomeOtherService otherService = context.getBean(SomeOtherService.class);
        // æˆ–è€…
        SomeOtherService otherService2 = ContextHolder.getContext().getBean("someOtherService");
    }
}
```

### é¡¹ç›®å¯åŠ¨æ—¶ç›‘å¬å·¥å…·

é¡¹ç›®ä¸­ç»å¸¸èƒ½é‡åˆ°å¯åŠ¨æ—¶å°±éœ€è¦åŠ è½½æŸäº›åŠŸèƒ½çš„åœºæ™¯ï¼Œä¾‹å¦‚é¡¹ç›®å¯åŠ¨æ—¶éœ€è¦æ£€æŸ¥æ•°æ®åº“è¡¨æœ‰æ²¡æœ‰åˆ›å»ºï¼Œæ²¡æœ‰åˆ›å»ºåˆ™éœ€è¦åˆ›å»ºç›¸åº”çš„æ•°æ®ã€‚Springé»˜è®¤å·²ç»æ”¯æŒäº†è¿™ç§åŠ è½½æ–¹å¼ï¼Œä½†æœ‰äº›åœºæ™¯æˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨Springå®¹å™¨åŠ è½½ä¹‹å‰å¯åŠ¨ï¼Œæˆ‘ä»¬æä¾›äº†com.hbasesoft.framework.common.StartupListeneræ¥å£æ¥æ”¯æ’‘è¿™ç§åœºæ™¯ã€‚

> StartupListener.java

```java
public interface StartupListener {
    // å®šä¹‰å¤šä¸ªListenerä¹‹é—´çš„å…ˆåé¡ºåº
    default LoadOrder getOrder() {
        return LoadOrder.LAST;
    }

    // æ˜¯å¦å¯ç”¨è¯¥ç›‘å¬å™¨
    default boolean enable() {
        return true;
    }

    // Spring å®¹å™¨åŠ è½½ä¹‹å‰
    default void init() {
    }

    // Spring å®¹å™¨åŠ è½½å®Œæˆä¹‹å
    default void complete(ApplicationContext context) {
    }

    // é¡¹ç›®é”€æ¯å‰
    default void destory() {
    }

    enum LoadOrder {
        FIRST, MIDDLE, LAST
    }
}
```

å¦‚ä½•ä½¿ç”¨ï¼Ÿ

1. ç¼–å†™ä¸šåŠ¡ä»£ç å®ç°StartupListeneræ¥å£
2. åœ¨é¡¹ç›®çš„src/main/resources/META-INF/servicesä¸­éœ€è¦æ–°å»ºä¸€ä¸ªcom.hbasesoft.framework.common.StartupListeneræ–‡ä»¶ï¼Œé‡Œé¢çš„å†…å®¹æ˜¯å…·ä½“çš„å®ç°ç±»çš„å…¨ç§°ï¼Œå¤šä¸ªå®ç°ç±»éœ€è¦æ¢è¡Œ

> ExampleStartupListener.java

```java
public class ExampleStartupListener implements StartupListener {
    @Override
    public LoadOrder getOrder() {
        return LoadOrder.MIDDLE;
    }
    
    @Override
    public void init() {
        // Springå®¹å™¨åŠ è½½å‰æ‰§è¡Œ
        System.out.println("åˆå§‹åŒ–æ“ä½œ...");
    }
    
    @Override
    public void complete(ApplicationContext context) {
        // Springå®¹å™¨åŠ è½½åæ‰§è¡Œ
        System.out.println("Springå®¹å™¨åŠ è½½å®Œæˆï¼Œæ‰§è¡Œåç»­æ“ä½œ...");
    }
}
```

### æ–­è¨€

æ–­è¨€ä½¿ç”¨com.hbasesoft.framework.common.utils.Assertå·¥å…·ç±»ï¼Œç”¨äºå‚æ•°æ ¡éªŒå’Œä¸šåŠ¡é€»è¾‘æ ¡éªŒã€‚

> AssertTest.java

```java
@Test
public void notNull() {
    Object obj = new Object();
    Assert.notNull(obj, ErrorCodeDef.SYSTEM_ERROR_10001);
    System.out.println("obj ä¸æ˜¯null");
}

@Test
public void isNull() {
    Object obj = null;
    Assert.isNull(obj, ErrorCodeDef.SYSTEM_ERROR_10001);
    System.out.println("obj æ˜¯nullå¯¹è±¡");
}

@Test
public void isTrue() {
    boolean condition = true;
    Assert.isTrue(condition, ErrorCodeDef.SYSTEM_ERROR_10001);
    System.out.println("æ¡ä»¶ä¸ºtrue");
}

@Test
public void notEmpty() {
    String str = "hello";
    Assert.notEmpty(str, ErrorCodeDef.SYSTEM_ERROR_10001);
    System.out.println("å­—ç¬¦ä¸²ä¸ä¸ºç©º");
}

@Test
public void equals() {
    String str1 = "hello";
    String str2 = "hello";
    Assert.equals(str1, str2, ErrorCodeDef.SYSTEM_ERROR_10001);
    System.out.println("ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰");
}
```

### æ—¥å¿—å·¥å…·

æ¡†æ¶æä¾›äº†ä¸¤ç§æ–¹å¼æ‰“å°æ—¥å¿—ï¼š

1. åœ¨é¡¹ç›®ä¸­å®ä¾‹åŒ–com.hbasesoft.framework.common.utils.logger.Loggerç±»ï¼Œé€‚ç”¨äºéœ€è¦å°†æ—¥å¿—æ‰“å°åˆ°å›ºå®šæ–‡ä»¶ä¸­çš„åœºæ™¯ã€‚
2. å¦å¤–æä¾›äº†ä¸€ä¸ªå·¥å…·ç±»com.hbasesoft.framework.common.utils.logger.LoggerUtilå¯ä»¥æ–¹ä¾¿çš„ç›´æ¥æ‰“å°æ—¥å¿—ã€‚

> LoggerUtilç¤ºä¾‹

```java
@Service
public class SomeService {
    public void doSomething() {
        // æ™®é€šæ—¥å¿—è¾“å‡º
        LoggerUtil.info("æ‰§è¡Œäº†doSomethingæ–¹æ³•");
        
        try {
            // ä¸šåŠ¡é€»è¾‘
            performBusinessLogic();
        } catch (Exception e) {
            // é”™è¯¯æ—¥å¿—è¾“å‡º
            LoggerUtil.error("æ‰§è¡ŒdoSomethingæ–¹æ³•æ—¶å‘ç”Ÿé”™è¯¯", e);
        }
        
        // å¸¦å‚æ•°çš„æ—¥å¿—è¾“å‡º
        LoggerUtil.info("å¤„ç†äº†{0}æ¡æ•°æ®ï¼Œè€—æ—¶{1}ms", 100, 50);
    }
}
```

### æ—¥æœŸå¤„ç†

æä¾›äº†å¸¸è§æ—¥æœŸæ ¼å¼è½¬åŒ–çš„æ–¹æ³•ï¼Œcom.hbasesoft.framework.common.utils.date.DateUtilã€‚

> DateUtilTest.java

```java
@Test
public void string2Date() {
    long t1 = NUM_A;
    long t2 = NUM_B;
    long t3 = NUM_C;
    String d8 = "20180912";
    Date date = DateUtil.string2Date(d8);
    Assert.isTrue(date.getTime() == t1, ErrorCodeDef.SYSTEM_ERROR_10001);

    String d11 = "2018å¹´09æœˆ12æ—¥";
    date = DateUtil.string2Date(d11);
    Assert.isTrue(date.getTime() == t1, ErrorCodeDef.SYSTEM_ERROR_10001);

    String d10 = "2018-09-12";
    date = DateUtil.string2Date(d10);
    Assert.isTrue(date.getTime() == t1, ErrorCodeDef.SYSTEM_ERROR_10001);

    String d102 = "2018/09/12";
    date = DateUtil.string2Date(d102);
    Assert.isTrue(date.getTime() == t1, ErrorCodeDef.SYSTEM_ERROR_10001);

    String d14 = "20180912105355";
    date = DateUtil.string2Date(d14);
    Assert.isTrue(date.getTime() == t2, ErrorCodeDef.SYSTEM_ERROR_10001);

    String d17 = "20180912105355123";
    date = DateUtil.string2Date(d17);
    Assert.isTrue(date.getTime() == t3, ErrorCodeDef.SYSTEM_ERROR_10001);

    String d19 = "2018-09-12 10:53:55";
    date = DateUtil.string2Date(d19);
    Assert.isTrue(date.getTime() == t2, ErrorCodeDef.SYSTEM_ERROR_10001);

    String d192 = "2018/09/12 10:53:55";
    date = DateUtil.string2Date(d192);
    Assert.isTrue(date.getTime() == t2, ErrorCodeDef.SYSTEM_ERROR_10001);

    String d21 = "2018å¹´09æœˆ12æ—¥ 10æ—¶53åˆ†55ç§’";
    date = DateUtil.string2Date(d21);
    Assert.isTrue(date.getTime() == t2, ErrorCodeDef.SYSTEM_ERROR_10001);

    String d23 = "2018-09-12 10:53:55.123";
    date = DateUtil.string2Date(d23);
    Assert.isTrue(date.getTime() == t3, ErrorCodeDef.SYSTEM_ERROR_10001);

    String d232 = "2018/09/12 10:53:55.123";
    date = DateUtil.string2Date(d232);
    Assert.isTrue(date.getTime() == t3, ErrorCodeDef.SYSTEM_ERROR_10001);

    String str = "18å¹´9æœˆ12å·10ç‚¹53åˆ†55ç§’";
    date = DateUtil.string2Date(str, "yyå¹´Mæœˆddå·hhç‚¹mmåˆ†ssç§’");
    Assert.isTrue(date.getTime() == t2, ErrorCodeDef.SYSTEM_ERROR_10001);
}

@Test
public void date2String() {
    Date date = new Date(NUM_C);
    String d8 = DateUtil.date2String(date, DateConstants.DATE_FORMAT_8);
    Assert.equals(d8, "20180912", ErrorCodeDef.SYSTEM_ERROR_10001);

    String d11 = DateUtil.date2String(date, DateConstants.DATE_FORMAT_11);
    Assert.equals(d11, "2018å¹´09æœˆ12æ—¥", ErrorCodeDef.SYSTEM_ERROR_10001);

    String d10 = DateUtil.date2String(date, DateConstants.DATE_FORMAT_10);
    Assert.equals(d10, "2018-09-12", ErrorCodeDef.SYSTEM_ERROR_10001);

    String d102 = DateUtil.date2String(date, DateConstants.DATE_FORMAT_10_2);
    Assert.equals(d102, "2018/09/12", ErrorCodeDef.SYSTEM_ERROR_10001);

    String d14 = DateUtil.date2String(date, DateConstants.DATETIME_FORMAT_14);
    Assert.equals(d14, "20180912105355", ErrorCodeDef.SYSTEM_ERROR_10001);

    String d17 = DateUtil.date2String(date, DateConstants.DATETIME_FORMAT_17);
    Assert.equals(d17, "20180912105355123", ErrorCodeDef.SYSTEM_ERROR_10001);

    String d19 = DateUtil.date2String(date);
    Assert.equals(d19, "2018-09-12 10:53:55", ErrorCodeDef.SYSTEM_ERROR_10001);

    String d192 = DateUtil.date2String(date, DateConstants.DATETIME_FORMAT_19_2);
    Assert.equals(d192, "2018/09/12 10:53:55", ErrorCodeDef.SYSTEM_ERROR_10001);

    String d21 = DateUtil.date2String(date, DateConstants.DATETIME_FORMAT_21);
    Assert.equals(d21, "2018å¹´09æœˆ12æ—¥ 10æ—¶53åˆ†55ç§’", ErrorCodeDef.SYSTEM_ERROR_10001);

    String d23 = DateUtil.date2String(date, DateConstants.DATETIME_FORMAT_23);
    Assert.equals(d23, "2018-09-12 10:53:55.123", ErrorCodeDef.SYSTEM_ERROR_10001);

    String d232 = DateUtil.date2String(date, DateConstants.DATETIME_FORMAT_23_2);
    Assert.equals(d232, "2018/09/12 10:53:55.123", ErrorCodeDef.SYSTEM_ERROR_10001);

    String str = DateUtil.date2String(date, "yyå¹´Mæœˆddå·hhç‚¹mmåˆ†ssç§’");
    Assert.equals(str, "18å¹´9æœˆ12å·10ç‚¹53åˆ†55ç§’", ErrorCodeDef.SYSTEM_ERROR_10001);
}
```

### å¸¸ç”¨å·¥å…·

æä¾›è·å–éšæœºæ•°ã€transIdã€æ¯”è¾ƒç­‰å¸¸è§æ–¹æ³•ï¼Œcom.hbasesoft.framework.common.utils.CommonUtilã€‚

> CommonUtilTest.java

```java
@Test
public void getTransactionID() {
    String str1 = CommonUtil.getTransactionID();
    String str2 = CommonUtil.getTransactionID();
    Assert.notEquals(str1, str2, ErrorCodeDef.SYSTEM_ERROR_10001);
    System.out.println("ç”Ÿæˆäº†ä¸¤ä¸ªä¸ä¸€æ ·çš„ä¸²ç ");
}

@Test
public void getRandom() {
    int random1 = CommonUtil.getRandom(100);
    int random2 = CommonUtil.getRandom(100);
    // ä¸¤ä¸ªéšæœºæ•°å¾ˆå¯èƒ½ä¸ç›¸ç­‰
    System.out.println("éšæœºæ•°1: " + random1 + ", éšæœºæ•°2: " + random2);
}
```

### æ–‡ä»¶æµ

æä¾›äº†æ–‡ä»¶è¯»å–ã€æµè½¬åŒ–ã€æ–‡ä»¶æ‹·è´ç­‰æ–¹æ³•ï¼Œcom.hbasesoft.framework.common.utils.io.IOUtilã€‚

> IOUtilç¤ºä¾‹

```java
@Service
public class FileService {
    public void processFile(String filePath) {
        try {
            // è¯»å–æ–‡ä»¶å†…å®¹
            String content = IOUtil.readFileToString(new File(filePath), "UTF-8");
            
            // å†™å…¥æ–‡ä»¶
            IOUtil.writeStringToFile(new File("output.txt"), content, "UTF-8");
            
            // æ–‡ä»¶æ‹·è´
            IOUtil.copyFile(new File(filePath), new File("backup.txt"));
            
        } catch (IOException e) {
            LoggerUtil.error("æ–‡ä»¶å¤„ç†å¤±è´¥", e);
        }
    }
}
```

### å‹ç¼©å·¥å…·

æä¾›äº†ZIPæ–‡ä»¶çš„å‹ç¼©å’Œè§£å‹åŠŸèƒ½ï¼Œcom.hbasesoft.framework.common.utils.io.FileZipUtilã€‚

> FileZipUtilç¤ºä¾‹

```java
@Service
public class ZipService {
    public void zipFiles() {
        try {
            // å‹ç¼©æ–‡ä»¶
            FileZipUtil.zipFiles(
                Arrays.asList(new File("file1.txt"), new File("file2.txt")),
                new File("archive.zip")
            );
            
            // è§£å‹æ–‡ä»¶
            FileZipUtil.unzip(new File("archive.zip"), new File("extracted/"));
            
        } catch (IOException e) {
            LoggerUtil.error("å‹ç¼©/è§£å‹å¤±è´¥", e);
        }
    }
}
```

### æ¨¡æ¿å¼•æ“

æä¾›äº†Javascriptã€Velocityã€OGNLè¡¨è¾¾å¼çš„è§£ææ–¹æ³•ã€‚

> VelocityParseFactoryTest.java

```java
@Test
public void parse() {
    Bean bean = new Bean("å¼ ä¸‰", NUM_18);
    Map<String, Object> params = new HashMap<>();
    params.put("b", bean);

    String template = "ä½ å¥½ï¼Œæˆ‘çš„åå­—å«${b.name}";
    String str = VelocityParseFactory.parse("template01", template, params);
    Assert.equals(str, "ä½ å¥½ï¼Œæˆ‘çš„åå­—å«å¼ ä¸‰", ErrorCodeDef.SYSTEM_ERROR_10001);
}
```

> JavaScriptUtilTest.java

```java
@Test
public void eval() {
    String script = "1+1";
    Double result = Double.valueOf(CommonUtil.getString(JavaScriptUtil.eval(script, null)));
    Assert.isTrue(result - 2 == 0, ErrorCodeDef.SYSTEM_ERROR_10001);

    Bean bean = new Bean("å¼ ä¸‰", NUM_18);
    Map<String, Object> params = new HashMap<>();
    params.put("b", bean);

    script = "b.getAge() + 2";
    result = Double.valueOf(CommonUtil.getString(JavaScriptUtil.eval(script, params)));
    Assert.isTrue(result - NUM_20 == 0, ErrorCodeDef.SYSTEM_ERROR_10001);
}
```

### Httpå·¥å…·

æä¾›äº†Http Getã€Postã€ä¸‹è½½æ–‡ä»¶ç­‰æ–¹æ³•çš„å¿«é€Ÿè®¿é—®ï¼Œcom.hbasesoft.framework.common.utils.io.HttpUtilã€‚

> HttpUtilTest.java

```java
@Test
public void doGet() {
    System.out
        .println(HttpUtil.doGet("https://jintan.towngasvcc.com/?null&ticket=2ccd00830d4448668b573c803f599c0f"));
    System.out.println(HttpUtil.doGet("https://www.towngasvcc.com", "utf-8"));
}

@Test
public void doPost() {
    Map<String, String> param = new HashMap<>();
    System.out.println(HttpUtil.doPost("http://www.baidu.com", param));
}

@Test
public void doGetDowloadFile() {
    HttpUtil.doGetDowloadFile("https://timgsa.baidu.com/timg?image"
        + "&quality=80&size=b9999_10000&sec=1506669107&di=3f964616fbb30dc8e9090f3921ce6dbf"
        + "&imgtype=jpg&er=1&src=http%3A%2F%2Fimgsrc.baidu.com%2Fbaike%2Fpic%"
        + "2Fitem%2Fcb8065380cd79123ea3a4a45af345982b2b7802d.jpg", "a2.jpg");
}
```

### å¸¸ç”¨çš„æ•°æ®å¤„ç†å·¥å…·

æä¾›md5ã€base64ã€å¯†ç åŠ å¯†ã€è§£å¯†ã€å­—èŠ‚è½¬16è¿›åˆ¶å­—ç¬¦ç­‰æ–¹æ³•ï¼Œcom.hbasesoft.framework.common.utils.security.DataUtilã€‚

> DataUtilTest.java

```java
@Test
public void md5For16() {
    String str1 = "123456";
    String str2 = DataUtil.md5For16(str1);
    Assert.equals(str2, "49BA59ABBE56E057", ErrorCodeDef.SYSTEM_ERROR_10001);
}

@Test
public void base64Encode() {
    String str = "hello world";
    String encoded = DataUtil.base64Encode(str);
    String decoded = DataUtil.base64Decode(encoded);
    Assert.equals(str, decoded, ErrorCodeDef.SYSTEM_ERROR_10001);
}
```

### åŠ å¯†å·¥å…·

æ¡†æ¶æä¾›äº†å¤šç§åŠ å¯†å·¥å…·ç±»ï¼š

1. DESUtil - DESåŠ å¯†è§£å¯†
2. RSAUtil - RSAåŠ å¯†è§£å¯†
3. JWTUtil - JWTä»¤ç‰Œç”Ÿæˆå’Œè§£æ
4. URLUtil - URLç¼–ç è§£ç 

> åŠ å¯†å·¥å…·ç¤ºä¾‹

```java
@Service
public class SecurityService {
    public void encryptData() {
        try {
            String data = "æ•æ„Ÿæ•°æ®";
            
            // DESåŠ å¯†
            String desKey = "12345678";
            String encrypted = DESUtil.encrypt(data, desKey);
            String decrypted = DESUtil.decrypt(encrypted, desKey);
            
            // RSAåŠ å¯†
            RSAUtil.RSAKeyPair keyPair = RSAUtil.generateKeyPair();
            String rsaEncrypted = RSAUtil.encrypt(data, keyPair.getPublicKey());
            String rsaDecrypted = RSAUtil.decrypt(rsaEncrypted, keyPair.getPrivateKey());
            
            // JWTç”Ÿæˆ
            Map<String, Object> claims = new HashMap<>();
            claims.put("username", "user123");
            String jwt = JWTUtil.generateToken(claims, "secretKey", 3600);
            
        } catch (Exception e) {
            LoggerUtil.error("åŠ å¯†å¤„ç†å¤±è´¥", e);
        }
    }
}
```

### åºåˆ—åŒ–å·¥å…·

ç›®å‰é‡‡ç”¨äº†protostuffåè®®åšçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œcom.hbasesoft.framework.common.utils.bean.SerializationUtilã€‚

> SerializationUtilTest.java

```java
@Test
public void serial() {
    Bean bean = new Bean("hello world", NUM_18);
    byte[] bs = SerializationUtil.serial(bean);
    String hexStr = DataUtil.byte2HexStr(bs);
    Assert.equals(hexStr, "0A0B68656C6C6F20776F726C641012", ErrorCodeDef.SYSTEM_ERROR_10001);
}

@Test
public void unserial() {
    byte[] bs = DataUtil.hexStr2Byte("0A0B68656C6C6F20776F726C641012");
    Bean bean = SerializationUtil.unserial(Bean.class, bs);
    Assert.equals(bean.getName(), "hello world", ErrorCodeDef.SYSTEM_ERROR_10001);
}
```

### Xmlå¤„ç†å·¥å…·

æä¾›äº†java beanè½¬xmlã€xmlè½¬java beançš„æ–¹æ³•ï¼Œcom.hbasesoft.framework.common.utils.xml.XmlBeanUtilã€‚

> XmlTest.java

```java
@Test
public void bean2xml() {
    Student student = new Student();
    student.setAge(NUM_10);
    student.setName("å°æ˜");
    student.setRemark("å°æ˜æ˜¯ä½å¥½åŒå­¦ï¼Œ<hello>å¹´å¹´ä¸‰å¥½å­¦ç”ŸğŸ‘©â€ğŸ“");

    System.out.println(XmlBeanUtil.object2Xml(student));
}

@Test
public void xml2bean() {
    String xml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><student><name>å°æ˜</name><age>10</age><remark>"
        + "<![CDATA[å°æ˜æ˜¯ä½å¥½<abcdedf>åŒå­¦ï¼Œå¹´å¹´ä¸‰å¥½å­¦ç”ŸğŸ‘©â€ğŸ“]]></remark></student>";
    Student student = XmlBeanUtil.xml2Object(xml, Student.class);
    System.out.println(student.getAge());
    System.out.println(student.getName());
    System.out.println(student.getRemark());
}
```

### çº¿ç¨‹å·¥å…·

æä¾›äº†çº¿ç¨‹ç›¸å…³çš„å·¥å…·æ–¹æ³•ï¼Œcom.hbasesoft.framework.common.utils.thread.ThreadUtilã€‚

> ThreadUtilç¤ºä¾‹

```java
@Service
public class ThreadService {
    public void executeAsyncTask() {
        // å¼‚æ­¥æ‰§è¡Œä»»åŠ¡
        ThreadUtil.execute(() -> {
            // è€—æ—¶æ“ä½œ
            performLongRunningTask();
        });
        
        // å»¶è¿Ÿæ‰§è¡Œä»»åŠ¡
        ThreadUtil.schedule(() -> {
            // å»¶è¿Ÿæ‰§è¡Œçš„æ“ä½œ
            doSomething();
        }, 5, TimeUnit.SECONDS);
    }
    
    private void performLongRunningTask() {
        // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }
    
    private void doSomething() {
        System.out.println("å»¶è¿Ÿä»»åŠ¡æ‰§è¡Œ");
    }
}
```

### æœ€ä½³å®è·µ

1. **ç»Ÿä¸€å¼‚å¸¸å¤„ç†** - ä½¿ç”¨FrameworkExceptionåŠå…¶å­ç±»è¿›è¡Œå¼‚å¸¸ç®¡ç†
2. **åˆç†ä½¿ç”¨å·¥å…·ç±»** - æ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„å·¥å…·ç±»ï¼Œé¿å…é‡å¤é€ è½®å­
3. **é…ç½®æ–‡ä»¶ç®¡ç†** - åˆç†ç»„ç»‡é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨PropertyHolderç»Ÿä¸€ç®¡ç†
4. **æ—¥å¿—è§„èŒƒ** - ä½¿ç”¨LoggerUtilè¿›è¡Œæ—¥å¿—è¾“å‡ºï¼Œéµå¾ªæ—¥å¿—çº§åˆ«è§„èŒƒ
5. **å¯åŠ¨ç›‘å¬** - åˆç†ä½¿ç”¨StartupListenerè¿›è¡Œåˆå§‹åŒ–æ“ä½œ
6. **èµ„æºé‡Šæ”¾** - æ³¨æ„èµ„æºçš„æ­£ç¡®é‡Šæ”¾ï¼Œç‰¹åˆ«æ˜¯åœ¨destoryæ–¹æ³•ä¸­
